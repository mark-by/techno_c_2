language: c
dist: bionic
sudo: true

before_install:
    - sudo apt-get install cppcheck valgrind -y
script:
    - cppcheck --inconclusive --enable=all --check-config --suppress=missingIncludeSystem -I include --language=c src
    - ./configure
    - cd build
    - make test
    - valgrind --tool=memcheck --gen-suppressions=all --leak-check=full --track-origins=yes --vgdb=no --child-silent-after-fork=yes ./test/run_tests
    - valgrind --tool=memcheck --gen-suppressions=all --leak-check=full --track-origins=yes --vgdb=no --child-silent-after-fork=yes ./test/run_tests_s
